<%- include("include/_adminHeader") %>


<!-- Modals --->
<div id="addModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeAddModal">&times;</span>
    <h2>Add New Partner</h2>
    <form id="addPartner">
      <div>
        <label for="name">Name:</label><br>
        <input type="text" id="name" name="name" required />
      </div>
      <div>
        <label for="url">url:</label><br>
        <input type="text" id="url" name="url" required />
      </div>
      <div>
        <label for="donator">Donator? </label><br>
        <input type="checkbox" id="donator" name="donator" />
      </div>
      <div>
        <label for="partnerImageFile">Logo:</label><br>
        <input type="file" id="partnerImageFile" accept="image/*" required />
        <input type="hidden" id="partnerImageData" name="imageData" />
      </div>
      <button id="addPartnerButton" type="submit">Add Partner</button>
    </form>
  </div>
</div>

<div class="modal" id="editModal">
  <div class="modal-content">
    <span class="close" id="closeEditModal">&times;</span>
    <h2>Edit Member</h2>
    <form id="editPartnerForm">
      <input type="hidden" id="editPartnerId" name="partnerId" />
      <div>
        <label for="editName">Name:</label><br>
        <input type="text" id="editName" name="=editName" required />
      </div>
      <div>
        <label for="editUrl">url:</label><br>
        <input type="text" id="editUrl" name="editUrl" required />
      </div>
      <div>
        <label for="editDonator">Donator? </label><br>
        <input type="checkbox" id="editDonator" name="editDonator" />
      </div>
      <div>
        <label for="editPartnerImageFile">Logo:</label><br>
        <input type="file" id="editPartnerImageFile" accept="image/*" required />
        <input type="hidden" id="editPartnerImageData" name="imageData" />
      </div>
      <button id="editPartnerButton" type="submit">Edit Partner</button>
    </form>
  </div>
</div>

<div id="deleteModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeDeleteModal">&times;</span>
    <h2>Confirm Deletion</h2>
    <p>Are you sure you want to delete this partner?</p>
    <input type="hidden" id="deletePartnerId" />
    <button id="confirmDeleteButton">Yes, Delete</button>
    <button id="cancelDeleteButton">Cancel</button>
  </div>
</div>
<!-- Main Content --->
<div class="container mt-4 text-center">
  <h1>Admin - Partners</h1>
  <button class="btn btn-success mb-3" id="openAddModal">Add New Partner</button>
  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>url</th>
        <th>Group</th>
        <th>Logo</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% partners.forEach(partner => { %>
        <tr data-id="<%= partner._id %>" data-name="<%= partner.name %>" data-url="<%= partner.url %>" data-donator="<%= partner.donator %>">
          <td><%= partner.name %></td>
          <td><%= partner.url %></td>
          <td><%= partner.donator ? "Donator" : "Recipient" %></td>
          <td><img src="data:image/jpeg;base64,<%= partner.imageData.toString('base64') %>" alt="<%= partner.name %>" class="img-thumbnail" width="100"></td>
          <td>
            <button class="btn btn-primary" onclick="editPartner('<%= partner._id %>')">Edit</button>
            <button class="btn btn-danger" onclick="deletePartner('<%= partner._id %>')">Delete</button>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<script src="/js/partners.js"></script>